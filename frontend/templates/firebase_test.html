{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Capita</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link href="{% static 'css/output.css' %}" rel="stylesheet">
    <link rel="icon" href="{% static "images/logo/icone_cor.svg" %}" type="image/svg+xml" />
    <style>
      body {
        background-color: #685cdc;
      }
    </style>
  </head>
  <body class="min-h-screen flex items-center justify-end">
    <img src="{% static "images/logo/icone_branco.png" %}" class="w-auto h-[220px] absolute left-[110px]">
    <div class="mr-10 relative p-[13px]">
      <div class="absolute inset-0 border-2 border-white rounded-[30px] bg-transparent -z-10"></div>
      <div class="borda-externa bg-white flex w-[1450px] max-w-[75vw] min-h-[600px] max-h-[75vh] rounded-[34px] shadow-lg">
        <!-- Lado esquerdo: Imagem -->
        <div class="flex-1 flex items-start pt-14 justify-center bg-[#f7f7fb] rounded-l-[34px]">
          <!-- Coloque sua imagem SVG ou IMG aqui -->
          <img src="{% static "images/logo/capita.tif_cor.png" %}" class="w-auto h-[80px] object-contain">
        </div>
        <!-- Lado direito: FormulÃ¡rios -->
        <div class="flex-[1.2] flex flex-col justify-center px-10 mt-8 py-12 rounded-r-[34px] bg-white">
          <a href="{% url 'home' %}" class="text-[#685cdc] hover:underline cursor-pointer absolute bottom-8 right-12">Entre sem uma conta</a>
          <!-- Registro -->
          <form id="registerForm" class="flex flex-col gap-3 items-center">
            <h1 class="font-bold text-[20px]">Criar Conta</h1>
            <div class="flex items-center bg-gray-100 rounded-lg px-3 gap-4">
              <img src="{% static "images/icons/user_black.svg" %}" alt="Icone de usuario">
              <input type="text" id="regName" name="name" placeholder="Nome completo" required class="bg-transparent flex-1 py-3 w-[380px] h-[50px] outline-none text-gray-700" />
            </div>
            <div class="flex items-center bg-gray-100 rounded-lg px-3 gap-4">
              <img src="{% static "images/icons/email_icon_black.svg" %}" alt="Icone de email">
              <input type="email" id="regEmail" name="email" placeholder="Email" required class="bg-transparent flex-1 py-3 w-[380px] h-[50px] outline-none text-gray-700" />
            </div>
            <div class="flex items-center bg-gray-100 rounded-lg px-3 gap-4">
              <img src="{% static "images/icons/key_black.svg" %}" alt="Icone de senha" class="rotate-[135deg]">
              <input type="password" id="regPassword" name="password" placeholder="Senha" required class="bg-transparent flex-1 py-3 w-[380px] h-[50px] outline-none text-gray-700" />
            </div>
            <button type="submit" id="registerBtn" class="mt-2 p-3 bg-[#685cdc] text-white font-bold rounded-lg hover:bg-[#574bb3] w-[300px] transition">Cadastrar</button>
            <div class="msg text-center min-h-[22px]" id="registerResult"></div>
          </form>
          <!-- Separador -->
          <div class="flex items-center my-4">
            <div class="flex-1 h-px bg-gray-200"></div>
            <span class="mx-3 text-gray-400 text-sm">OU</span>
            <div class="flex-1 h-px bg-gray-200"></div>
          </div>
          <!-- Login -->
          <form id="loginForm" class="flex flex-col gap-3 mt-2 items-center">
            <h1 class="font-bold text-[20px]">Entrar</h1>
            <div class="flex items-center bg-gray-100 rounded-lg px-3 gap-4">
              <img src="{% static "images/icons/email_icon_black.svg" %}" alt="Icone de email">
              <input type="email" id="loginEmail" name="email" placeholder="Email" required class="bg-transparent flex-1 py-3 w-[380px] h-[50px] outline-none text-gray-700" />
            </div>
            <div class="flex items-center bg-gray-100 rounded-lg px-3 gap-4">
              <img src="{% static "images/icons/key_black.svg" %}" alt="Icone de senha" class="rotate-[135deg]">
              <input type="password" id="loginPassword" name="password" placeholder="Senha" required class="bg-transparent flex-1 py-3 w-[380px] h-[50px] outline-none text-gray-700" />
            </div>
            <div class="flex items-center justify-between text-sm mt-2 w-[300px]">
              <label class="flex items-center gap-2">
                <input type="checkbox" class="accent-[#685cdc]">
                <span class="text-gray-600">Lembrar-me</span>
              </label>
              <a href="#" class="text-[#685cdc] hover:underline">Esqueceu a senha?</a>
            </div>
            <button type="submit" id="loginBtn" class="mt-4 bg-[#685cdc] text-white font-bold rounded-lg py-3 hover:bg-[#574bb3] w-[300px] transition">Entrar</button>
            <div class="msg text-center mt-2 min-h-[22px]" id="loginResult"></div>
          </form>
        </div>
      </div>
    </div>
    <script type="module">
      console.log("Script do template executado");

      const showLogin = document.getElementById("showLogin");
      const showRegister = document.getElementById("showRegister");
      
      window.firebaseConfig = {
        apiKey: "{{ FB_API_KEY }}",
        authDomain: "{{ FB_AUTH_DOMAIN }}",
        projectId: "{{ FB_PROJECT_ID }}",
        storageBucket: "{{ FB_STORAGE_BUCKET }}",
        messagingSenderId: "{{ FB_MESSAGING_SENDER_ID }}",
        appId: "{{ FB_APP_ID }}",
        measurementId: "{{ FB_MEASUREMENT_ID }}"
      };
      console.log("Config definida no template:", window.firebaseConfig);


      if (window.location.search.includes('logout=1')) {
        localStorage.clear();
        sessionStorage.clear();
        document.cookie.split(';').forEach(cookie => {
            document.cookie = cookie.replace(/^ +/, '')
                .replace(/=.*/, `=;expires=${new Date(0).toUTCString()};path=/`);
        });
        window.location.href = "{% url 'login' %}?nocache=" + Date.now();
      }
    </script>
    <script type="module" src="{% static 'js/firebase_auth.js' %}"></script>
  </body>
</html>